# Example testing env for Reserva app
# Copy this file to .env.testing in `backend/src` before running tests if you need
# to override environment values used by phpunit.phpunit.xml or artisan.

# -----------------------------
# Option A: In-memory sqlite (recommended for unit tests)
# -----------------------------
# Use this when running PHPUnit or tests inside CI. No disk DB is created and
# migrations run on an ephemeral in-memory database.
APP_ENV=testing
DB_CONNECTION=sqlite
DB_DATABASE=:memory:
CACHE_STORE=array
QUEUE_CONNECTION=sync
SESSION_DRIVER=array
MAIL_MAILER=array
BCRYPT_ROUNDS=4

# -----------------------------
# Option B: File-backed sqlite (persist test DB between runs)
# -----------------------------
# If you prefer a persistent test DB that survives process restarts, use a
# file-backed sqlite database. The path is relative to the `backend/src`
# directory (Laravel will resolve it from your app base path).
# To use this option, set DB_DATABASE to a file path (create the file first).

# Example (uncomment to use):
# DB_CONNECTION=sqlite
# DB_DATABASE=./database/testing.sqlite

# When using the file-based sqlite option, you'll typically run:
#   cd backend/src
#   touch database/testing.sqlite
#   cp .env.testing.example .env.testing
#   # generate key for testing env (only needed if tests rely on APP_KEY)
#   php artisan key:generate --env=testing --no-interaction
#   # run migrations against the testing sqlite file
#   php artisan migrate --env=testing --force
#   # run phpunit (phpunit.xml already sets APP_ENV=testing and sqlite :memory: by default)
#   ./vendor/bin/phpunit

# -----------------------------
# Safety / overrides
# -----------------------------
# The repository includes a safety guard that refuses to run tests unless
# APP_ENV=testing and DB is an in-memory sqlite, to avoid accidental data loss.
# If you intentionally want to run tests against a non-testing DB, set:
#   export ALLOW_TESTS_ON_NON_TEST_DB=1
# before running PHPUnit.

# -----------------------------
# Notes
# -----------------------------
# - phpunit.xml in this project already sets APP_ENV=testing and DB_DATABASE=:memory:
#   so in most cases you don't need a .env.testing file. This example is useful
#   when you want to run tests against a file-backed sqlite DB or a dedicated
#   test mysql/postgres instance (in that case, set DB_CONNECTION and DB_* vars).
# - For MySQL/Postgres testing, create a separate database (e.g., reservas_test)
#   and set DB_CONNECTION, DB_HOST, DB_PORT, DB_DATABASE, DB_USERNAME and DB_PASSWORD
#   in your `.env.testing`.
